// Generated by CoffeeScript 1.6.3
(function() {
  var activateTooltips, bindFunctions, indentImages, searchDataArrived, shiftFooter,
    _this = this;

  this.newSearch = function() {
    var searchterm;
    searchterm = $('#input-searchterm').val();
    $('#loading-popup-searchterm').text(searchterm);
    $('#loading-popup').modal('show');
    return $('#results').load("http://localhost:5000/search/" + searchterm + " #result-container", searchDataArrived).fadeIn("slow");
  };

  searchDataArrived = function(responseText, textStatus, XMLHttpRequest) {
    if (textStatus !== "success") {
      $('#loading-popup');
    }
    $('#loading-popup').modal('hide');
    console.log("Search data arrived:", textStatus);
    indentImages();
    activateTooltips();
    return shiftFooter();
  };

  activateTooltips = function() {
    $('.result-synset').tooltip({
      selector: '',
      placement: 'left',
      container: 'body',
      html: 'true'
    });
    return $('img').tooltip({
      selector: '',
      placement: 'bottom',
      container: 'body',
      html: 'true'
    });
  };

  indentImages = function() {
    var max_width;
    max_width = 0;
    $('.result-name').each(function() {
      if ($(this).width() > max_width) {
        return max_width = $(this).width();
      }
    });
    return $('.result-name').width(max_width);
  };

  shiftFooter = function() {
    if ($("body").height() - ($("#main-navigation").height() + $("#results").height()) > 0) {
      return $("footer").css({
        position: "absolute",
        left: ($("body").width() - $(".container").width()) / 2,
        bottom: 0
      });
    } else {
      return $("footer").css({
        position: "relative",
        left: 0,
        bottom: 0
      });
    }
  };

  bindFunctions = function() {
    return $('#input-searchterm').keyup(function(e) {
      if (e.keyCode === 13) {
        return newSearch();
      }
    });
  };

  $.ready = function() {
    $('#loading-popup').modal('hide');
    $("#input-searchterm").focus();
    return shiftFooter();
  };

}).call(this);
